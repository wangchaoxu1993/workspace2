var FDWindowView=function(a){FDWindowView.superclass.constructor.call(this,a);FDLib.dom.addClass(this.getPanelContentDiv(),"shadow");this.btnId=this.options.domId+"btnId"+this.panelCount;this._createBgModal();this.setDragable(this.options.dragable)};FDLib.extend(FDWindowView,FDPanelView);FDWindowView.zIndex=200;FDWindowView.getNextZ_Index=function(){return ++FDWindowView.zIndex};FDWindowView.prototype.show=function(){if(this.options.modal){this.showBgModal()}this.getPanelDiv().style.zIndex=FDWindowView.getNextZ_Index();this.getPanelDiv().style.display="";this._runAfterShowHandler()};FDWindowView.prototype.close=function(){this.hideBgModal();this.getPanelDiv().style.display="none";this._runAfterCloseHandler()};FDWindowView.prototype.moveTo=function(b,a){this.getPanelDiv().style.left=b+"px";this.getPanelDiv().style.top=a+"px"};FDWindowView.prototype.setDragable=function(){var a=this.getTitleDiv();if(this.couldMoveWindow()){FDDragUtil.regist(this.getPanelDiv(),a);this.moveToCenter()}else{FDDragUtil.destory(a)}};FDWindowView.prototype.moveToCenter=function(){FDDragUtil.moveToCenter(this.getPanelDiv())};FDWindowView.prototype.couldMoveWindow=function(){return this.options.dragable};FDWindowView.prototype.showBgModal=function(){this.bgModal.style.display="";this.bgModal.style.zIndex=FDWindowView.getNextZ_Index()};FDWindowView.prototype.hideBgModal=function(){this.bgModal.style.display="none"};FDWindowView.prototype.buildPanel=function(){this._buildWindowPanel();this._setContentChild()};FDWindowView.prototype._buildButtons=function(){var b=this.options.buttons;var a=[];if(FDLib.util.isArray(b)){FDLib.util.each(b,function(d,c){if(!(d instanceof FDButton)){d=new FDButton(d);b[c]=d}a.push(d)});this._appendButtons(a)}};FDWindowView.prototype._appendButtons=function(b){if(b.length>0){var a=this.getBtnDiv();FDLib.util.each(b,function(c){c.renderToDom(a)})}};FDWindowView.prototype._buildWindowPanel=function(){var b=this.getPanelDivTemplate();var a=FDLib.string.format(b,this._getTitleAndContentObj());this.getPanelDiv().innerHTML=a;document.body.appendChild(this.getPanelDiv())};FDWindowView.prototype._setContentChild=function(){var a=FDLib.getEl(this.options.domId);if(!a){throw new Error("找不到窗体内容,请设置正确的domId")}this.appendContentChild(a)};FDWindowView.prototype.getBtnDiv=function(){return FDLib.getEl(this.btnId)};FDWindowView.prototype._getTitleAndContentObj=function(){var a=FDWindowView.superclass._getTitleAndContentObj.call(this);a.btnId=this.btnId;return a};FDWindowView.prototype.getCloseArea=function(){if(this.options.closeable){var a=new JString();var b="FDPanelView.panelMap["+this.panelCount+"].close()";a.append('<span class="close"><a href="javascript:void(0);" onclick="'+b+'">').append(this.options.closeText).append("</a></span>");return a.toString()}return""};FDWindowView.prototype._createBgModal=function(){var d=document;this.bgModal=d.createElement(FDTag.DIV);var a=Math.max(d.documentElement.clientHeight,d.body.scrollHeight);var b=this.options.modelColor;var c=this.options.modelOpacity;this.bgModal.style.cssText="position:absolute;left:0px;top:0px;width:100%;height:"+a+"px;filter:Alpha(Opacity="+(c*100)+");opacity:"+c+";background-color:"+b+";";this.bgModal.style.display="none";document.body.appendChild(this.bgModal)};FDWindowView.prototype._runAfterShowHandler=function(){var a=this.options.afterShow;if(FDLib.util.isFunction(a)){a()}};FDWindowView.prototype._runAfterCloseHandler=function(){var a=this.options.afterClose;if(FDLib.util.isFunction(a)){a()}};FDWindowView.prototype.getPanelDivTemplate=function(){return FDWindowView.panelFrameTemplate};FDPanelView.panelFrameTemplate=['<div id="{panelContentDivId}" class="pui-panel ui-widget ui-widget-content ui-corner-all">','<div id="{titleDivId}" class="pui-panel-titlebar ui-widget-header ui-helper-clearfix ui-corner-all">','<span id="{titleId}" class="ui-panel-title">{title}</span>','<a id="{closeBtnId}" {closeHandlerArea} style="display:none;" class="pui-panel-titlebar-icon ui-corner-all ui-state-default" href="#">','<span class="ui-icon ui-icon-closethick"></span>',"</a>",'<a id="{toggleBtnId}" {toggleHandlerArea} style="display:none;" class="pui-panel-titlebar-icon ui-corner-all ui-state-default" href="#">','<span id="{toggleBtnId}" class="ui-icon ui-icon-minusthick"></span>',"</a>","</div>",'<div id="{contentId}" class="pui-panel-content ui-widget-content">',"</div>","</div>"].join("");FDWindowView.panelFrameTemplate=['<div id="{panelContentDivId}" class="pui-dialog ui-widget ui-widget-content ui-corner-all pui-shadow ui-draggable ui-resizable">','<div id="{titleDivId}" class="pui-dialog-titlebar ui-widget-header ui-helper-clearfix ui-corner-top">','<span id="{titleId}" class="pui-dialog-title">{title}</span>','<a id="{closeBtnId}" {closeHandlerArea} class="pui-dialog-titlebar-icon pui-dialog-titlebar-close ui-corner-all" href="#">','<span class="ui-icon ui-icon-close"/>',"</a>",'<a id="{toggleBtnId}" {toggleHandlerArea} class="pui-dialog-titlebar-icon pui-dialog-titlebar-minimize ui-corner-all" href="#" role="button">','<span class="ui-icon ui-icon-minus"/>',"</a>","</div>",'<div id="{contentId}" class="pui-dialog-content ui-widget-content" style="height: auto; width: auto; display: block;"> ',"</div>",'<div id={btnId} class="pui-dialog-buttonpane ui-widget-content ui-helper-clearfix" style="display: block;">',"</div>","</div>"].join("");