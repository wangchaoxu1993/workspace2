var FDSettingView=function(a){this.options=a;this.settingDiv=document.createElement(FDTag.DIV);this.settingDiv.id=this.options.domId+"_setting";document.body.appendChild(this.settingDiv);this.gridDom=FDLib.getEl(this.options.domId);this.grid=a.getGrid();this.settingWin=this._createSettingWin();this.tab=this._createTab();this.checkbox;var c=this.options.afterSearch||function(){};var b=this;this.options.afterSearch=function(){c(a.getGrid(),a);b.init()}};FDSettingView.prototype={_createSettingWin:function(){var a=new FDWindow({contentId:this.settingDiv.id,title:"设置项",modal:true,buttons:[new FDButton({text:"关闭",onclick:function(){a.close()}})]});return a},_createTab:function(){var a=document.createElement(FDTag.DIV);a.id=this.options.domId+"_tab";this.settingDiv.appendChild(a);var b=new FDTab({domId:a.id,items:this._getTabItems()});return b},_getTabItems:function(){var a=this._createColumnSelect();return[{text:"列显示",value:1,contentId:a,checked:true}]},_createColumnSelect:function(){var a=document.createElement(FDTag.DIV);var b=this.options.domId+"_colSelectId";a.id=b;document.body.appendChild(a);this._createCheckboxes(a);return b},_createCheckboxes:function(e){var c=this.options.columns;var b=this._isHasSelectRowAbility();var a=[];var f=[];FDLib.util.each(c,function(j,h){var g=b?(h+1):h;a.push({text:j.text||"#",value:g});f.push(g)});this.checkbox=new FDCheckBox({items:a,defaultValue:f});this.checkbox.renderToDom(e);var d=this;this.checkbox.addEvent("click",function(){var h=this.value;var g=this.checked;d.columnSelectorHandler(h,g)})},_isHasSelectRowAbility:function(){return this.grid.isSelectStatus()},init:function(){var a=this.checkbox.getControlItems();var b=this;FDLib.util.each(a,function(e){var d=e.value;var c=e.checked;b.columnSelectorHandler(d,c)})},columnSelectorHandler:function(b,d){var e=this.grid.getThead();var a=e.getElementsByTagName("th");var c=this.grid.getTableTR();this.toggleHeadColumn(a,b,d);this.toggleBodyColumn(c,b,d)},toggleHeadColumn:function(a,c,b){var d=a[c];if(b){FDLib.dom.showDom(d)}else{FDLib.dom.hideDom(d)}},toggleBodyColumn:function(a,c,b){FDLib.util.each(a,function(d){var e=d.cells[c];if(b){FDLib.dom.showDom(e)}else{FDLib.dom.hideDom(e)}})},showWin:function(){this.settingWin.show()}};